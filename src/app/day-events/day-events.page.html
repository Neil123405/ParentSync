<ion-header [translucent]="true">
  <ion-toolbar style="--background: linear-gradient(135deg, #667eea 0%, #764ba2 100%)">
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/calendar" (click)="goBackToCalendar()"></ion-back-button>
    </ion-buttons>
    <ion-title style="color: white">Week View</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true">
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <full-calendar #fc [options]="calendarOptions"></full-calendar>

  <!-- Modern Events Card -->
  <div class="modern-card events-card">
    <div class="card-header">
      <div class="header-icon-wrapper events-theme">
        <ion-icon name="calendar" class="header-icon"></ion-icon>
      </div>
      <div class="header-content">
        <h2 class="card-title">Events for {{ selectedDay | date:'MMM d, yyyy' }}</h2>
        <p class="card-subtitle">{{ filteredEvents.length }} event{{ filteredEvents.length !== 1 ? 's' : '' }} scheduled</p>
      </div>
    </div>

    <div class="card-body" *ngIf="filteredEvents.length > 0; else noEventsTemplate">
      <div class="event-item" 
           *ngFor="let event of filteredEvents; let i = index" 
           (click)="openEventDetail(event)"
           [style.animation-delay]="i * 100 + 'ms'">
        
        <div class="event-date-badge">
          <span class="date-day">{{ event.start ? (event.start | date:'dd') : (event.date | date:'dd') }}</span>
          <span class="date-month">{{ event.start ? (event.start | date:'MMM') : (event.date | date:'MMM') }}</span>
        </div>
        
        <div class="event-content">
          <h3 class="event-title">{{ event.title }}</h3>
          <div class="event-details">
            <div class="event-time" *ngIf="event.time">
              <ion-icon name="time-outline" class="detail-icon"></ion-icon>
              <span>{{ event.time }}</span>
            </div>
            <div class="event-description" *ngIf="event.description">
              <ion-icon name="information-circle-outline" class="detail-icon"></ion-icon>
              <span>{{ event.description }}</span>
            </div>
            <div class="event-student" *ngIf="event.first_name && event.last_name">
              <ion-icon name="person-circle-outline" class="detail-icon"></ion-icon>
              <span>{{ event.first_name }} {{ event.last_name }}</span>
            </div>
            <div class="event-student" *ngIf="event.location">
              <ion-icon name="location-outline" class="detail-icon"></ion-icon>
              <span>{{ event.location }}</span>
            </div>
          </div>
        </div>
        
        <div class="event-arrow">
          <ion-icon name="chevron-forward" class="arrow-icon"></ion-icon>
        </div>
      </div>
    </div>

    <ng-template #noEventsTemplate>
      <div class="empty-state">
        <ion-icon name="calendar-clear-outline" class="empty-icon"></ion-icon>
        <h3 class="empty-title">No Events Today</h3>
        <p class="empty-subtitle">Your calendar is clear for this day</p>
      </div>
    </ng-template>
  </div>

  <!-- Modern Consent Forms Card -->
  <div class="modern-card forms-card">
    <div class="card-header">
      <div class="header-icon-wrapper forms-theme">
        <ion-icon name="document-text" class="header-icon"></ion-icon>
      </div>
      <div class="header-content">
        <h2 class="card-title">Consent Forms</h2>
        <p class="card-subtitle">{{ filteredForms.length }} form{{ filteredForms.length !== 1 ? 's' : '' }} pending</p>
      </div>
    </div>

    <div class="card-body" *ngIf="filteredForms.length > 0; else noFormsTemplate">
      <div class="form-item" 
           *ngFor="let form of filteredForms; let i = index" 
           (click)="openConsentFormDetail(form)"
           [style.animation-delay]="i * 100 + 'ms'">
        
        <div class="form-priority-badge">
          <ion-icon name="alert-circle" class="priority-icon"></ion-icon>
        </div>
        
        <div class="form-content">
          <h3 class="form-title">{{ form.title }}</h3>
          <div class="form-details">
            <div class="form-deadline" *ngIf="form.deadline">
              <ion-icon name="time-outline" class="detail-icon"></ion-icon>
              <span>Deadline: {{ form.deadline | date:'mediumDate' }}</span>
            </div>
            <div class="form-description" *ngIf="form.description">
              <ion-icon name="information-circle-outline" class="detail-icon"></ion-icon>
              <span>{{ form.description }}</span>
            </div>
            <div class="form-student" *ngIf="form.first_name && form.last_name">
              <ion-icon name="person-circle-outline" class="detail-icon"></ion-icon>
              <span>{{ form.first_name }} {{ form.last_name }}</span>
            </div>
          </div>
        </div>
        
        <div class="form-arrow">
          <ion-icon name="chevron-forward" class="arrow-icon"></ion-icon>
        </div>
      </div>
    </div>

    <ng-template #noFormsTemplate>
      <div class="empty-state">
        <ion-icon name="document-text-outline" class="empty-icon"></ion-icon>
        <h3 class="empty-title">No Pending Forms</h3>
        <p class="empty-subtitle">All consent forms are up to date</p>
      </div>
    </ng-template>
  </div>

  <!-- Dynamic bottom spacing -->
  <div style="height: 60px;"></div>
</ion-content>